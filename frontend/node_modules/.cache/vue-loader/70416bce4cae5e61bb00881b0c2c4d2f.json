{"remainingRequest":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspaces/WEB_SONAGI-ON_updraft/frontend/src/components/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/src/components/Profile.vue","mtime":1634292491593},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCc7CmltcG9ydCBMb2dpbkRpYWxvZyBmcm9tICcuL0xvZ2luRGlhbG9nLnZ1ZScKaW1wb3J0IFJlZ2lzdGVyIGZyb20gJy4vUmVnaXN0ZXIudnVlJwppbXBvcnQgVXNlclNldHRpbmcgZnJvbSAnLi9Vc2VyU2V0dGluZy52dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1Byb2ZpbGUnLAogIGNvbXBvbmVudHM6IHsgCiAgICBMb2dpbkRpYWxvZywKICAgIFJlZ2lzdGVyLAogICAgVXNlclNldHRpbmcsCiAgfSwKICBkYXRhOiAoKSA9PiAoewogICAgdXNlcmRhdGE6IHsibmlja25hbWUiOiLrrLTrqoUiLCAicmFuayI6IuqyjOyKpO2KuCJ9LAogIH0pLAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZShbJ2lzTG9naW4nLCAnYWNjZXNzX3Rva2VuJywgJ3JlZnJlc2hfdG9rZW4nXSksCiAgfSwKICBtZXRob2RzOiB7CiAgICAgLi4ubWFwQWN0aW9ucyhbJ2xvZ291dCddKSwKICAgICBpbml0UHJvZmlsZTogZnVuY3Rpb24oKSB7CiAgICAgICBpZih0aGlzLmlzTG9naW4pewogICAgICAgIGNvbnN0IGNvbmZpZyA9IHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYWNjZXNzX3Rva2VufWAsCiAgICAgICAgICB9LAogICAgICAgIH07CiAgICAgICAgdGhpcy5heGlvcy5nZXQoYCR7dGhpcy4kc3RvcmUuc3RhdGUuQkFDS0VORF9VUkx9L2FwaS91c2Vyc2V0dGluZy9nZXRgLCBjb25maWcpCiAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIHRoaXMudXNlcmRhdGEubmlja25hbWUgPSByZXMuZGF0YS5uaWNrbmFtZTsKICAgICAgICAgICAgbGV0IHByb21vdGlvbl9kYXRlcyA9IFtuZXcgRGF0ZShyZXMuZGF0YS5wcm9tb3Rpb24xX2RhdGUpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZShyZXMuZGF0YS5wcm9tb3Rpb24yX2RhdGUpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZShyZXMuZGF0YS5wcm9tb3Rpb24zX2RhdGUpXTsKICAgICAgICAgICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgLy8gdG9kbyA6IOu2gOyCrOq0gCwg7J6l6rWQ7JeQIOuMgO2VtOyEnOuPhCDrgpjtg4Drgrwg7IiYIOyeiOuPhOuhnQogICAgICAgICAgICBpZihyZXMuZGF0YS50eXBlID09PSAic29sZGllciIpewogICAgICAgICAgICAgIGxldCByYW5rcyA9IFsi7J2067ORIiwgIuydvOuzkSIsICLsg4Hrs5EiLCAi67OR7J6lIl07CiAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHByb21vdGlvbl9kYXRlcy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0b2RheSwgcHJvbW90aW9uX2RhdGVzW2ldKTsKICAgICAgICAgICAgICAgIGlmKHRvZGF5IDwgcHJvbW90aW9uX2RhdGVzW2ldKXsKICAgICAgICAgICAgICAgICAgdGhpcy51c2VyZGF0YS5yYW5rID0gcmFua3NbaV0KICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICBpZihlcnJvci5yZXNwb25zZS5kYXRhLmNvZGUgPT09ICJ0b2tlbl9ub3RfdmFsaWQiKXsKICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpOwogICAgICAgICAgICAgIGFsZXJ0KCLshLjshZjsnbQg66eM66OM65CY7JeI7Iq164uI64ukLiDri6Tsi5wg66Gc6re47J24IO2VtOyjvOyEuOyalC4iKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpOwogICAgICAgICAgICAgIGFsZXJ0KCJbUEYwMDFdIOyYiOyDgey5mCDrqrvtlZwg7JeQ65+s6rCAIOuwnOyDne2WiOyKteuLiOuLpC4iKQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudXNlcmRhdGEgPSB7Im5pY2tuYW1lIjoi66y066qFIiwgInJhbmsiOiLqsozsiqTtirgifTsKICAgICAgfQogICAgIH0sCiAgfSwKICB3YXRjaDogewogICAgaXNMb2dpbjogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuaW5pdFByb2ZpbGUoKTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmluaXRQcm9maWxlKCk7CiAgfQp9Cg=="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/components","sourcesContent":["<template>\n   <v-card height=\"350px\" class=\"d-flex align-center justify-center\">\n      <v-list>\n         <v-list-item>\n            <v-icon size=150>mdi-account-circle</v-icon>\n         </v-list-item>\n         <v-list-item>\n            <v-list-item-content>\n               <v-list-item-title class=\"text-h5 d-flex align-center justify-center\">{{userdata.nickname}}</v-list-item-title>\n               <v-list-item-subtitle class=\"d-flex align-center justify-center\">{{userdata.rank}}</v-list-item-subtitle>\n            </v-list-item-content>\n         </v-list-item>\n         <v-list-item class=\"justify-center\">\n            <template v-if=\"!isLogin\">\n                <v-row>\n                  <v-col>\n                    <LoginDialog />\n                  </v-col>\n                  <v-col>\n                    <Register />\n                  </v-col>\n                </v-row>\n            </template>\n            <template v-else>\n              <v-row>\n                  <v-col>\n                    <UserSetting />\n                  </v-col>\n                  <v-col>\n                    <v-row justify=\"center\">\n                      <v-btn\n                          color=\"grey darken-2 white--text\"\n                          dark\n                          @click=\"logout()\"\n                      > \n                          로그아웃\n                      </v-btn>\n                    </v-row>\n                  </v-col>\n               </v-row>\n            </template>\n         </v-list-item>\n      </v-list>\n   </v-card>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex';\nimport LoginDialog from './LoginDialog.vue'\nimport Register from './Register.vue'\nimport UserSetting from './UserSetting.vue'\n\nexport default {\n  name: 'Profile',\n  components: { \n    LoginDialog,\n    Register,\n    UserSetting,\n  },\n  data: () => ({\n    userdata: {\"nickname\":\"무명\", \"rank\":\"게스트\"},\n  }),\n  computed: {\n    ...mapState(['isLogin', 'access_token', 'refresh_token']),\n  },\n  methods: {\n     ...mapActions(['logout']),\n     initProfile: function() {\n       if(this.isLogin){\n        const config = {\n          headers: {\n            Authorization: `Bearer ${this.access_token}`,\n          },\n        };\n        this.axios.get(`${this.$store.state.BACKEND_URL}/api/usersetting/get`, config)\n          .then((res) => {\n            this.userdata.nickname = res.data.nickname;\n            let promotion_dates = [new Date(res.data.promotion1_date), \n                                   new Date(res.data.promotion2_date), \n                                   new Date(res.data.promotion3_date)];\n            let today = new Date();\n            // todo : 부사관, 장교에 대해서도 나타낼 수 있도록\n            if(res.data.type === \"soldier\"){\n              let ranks = [\"이병\", \"일병\", \"상병\", \"병장\"];\n              for(let i = 0; i < promotion_dates.length; i++){\n                console.log(today, promotion_dates[i]);\n                if(today < promotion_dates[i]){\n                  this.userdata.rank = ranks[i]\n                  break;\n                }\n              }\n            }\n          })\n          .catch((error) => {\n            if(error.response.data.code === \"token_not_valid\"){\n              this.logout();\n              alert(\"세션이 만료되었습니다. 다시 로그인 해주세요.\");\n            } else {\n              this.logout();\n              alert(\"[PF001] 예상치 못한 에러가 발생했습니다.\")\n            }\n          })\n      } else {\n        this.userdata = {\"nickname\":\"무명\", \"rank\":\"게스트\"};\n      }\n     },\n  },\n  watch: {\n    isLogin: function() {\n      this.initProfile();\n    }\n  },\n  created() {\n    this.initProfile();\n  }\n}\n</script>"]}]}