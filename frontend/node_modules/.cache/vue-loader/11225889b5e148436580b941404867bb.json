{"remainingRequest":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspaces/WEB_SONAGI-ON_updraft/frontend/src/views/DiaryWrite.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/src/views/DiaryWrite.vue","mtime":1634449137153},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcKaW1wb3J0IEVtb3Rpb25zIGZyb20gJy4uL2NvbXBvbmVudHMvRW1vdGlvbnMnCgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgRW1vdGlvbnMsCiAgfSwKICBkYXRhOiAoKT0+ICh7CiAgICBiY0xpbms6IFsKICAgICAgewogICAgICAgIHRleHQ6ICfrjIDsi5zrs7Trk5wnLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBocmVmOiAnRGFzaGJvYXJkJywKICAgICAgfSwKICAgICAgewogICAgICAgIHRleHQ6ICfsnbzquLAnLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBocmVmOiAnZGlhcnknLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGV4dDogJ+ydvOq4sCDsk7DquLAnLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBocmVmOiAnZGlhcnktd3JpdGUnLAogICAgICB9LAogICAgXSwKICAgIGVtb3Rpb246ICIiLAogICAgdGl0bGU6ICIiLAogICAgdGl0bGVSdWxlczogWwogICAgICB2ID0+ICEhdiB8fCAn7KCc66qp7J2AIO2VhOyImCDtla3rqqnsnoXri4jri6QuJywKICAgICAgdiA9PiB2Lmxlbmd0aCA8IDI1IHx8ICfsoJzrqqnsnYAgMjXsnpAg7J207ZWY66GcIOyggeyWtOyjvOyEuOyalC4nCiAgICBdLAogICAgY29udGVudDogIiIsCiAgICBjb250ZW50UnVsZXM6IFsKICAgICAgdiA9PiAhIXYgfHwgJ+uCtOyaqeydgCDtlYTsiJgg7ZWt66qp7J6F64uI64ukLicsCiAgICAgIHYgPT4gdi5sZW5ndGggPCAxNTAwIHx8ICfrgrTsmqnsnYAgMTUwMOyekCDsnbTtlZjroZwg7KCB7Ja07KO87IS47JqULicKICAgIF0sCiAgICBhcGlVcmw6ICJ3cml0ZSIsCiAgICBpc0xvYWRlZDogZmFsc2UsCiAgfSksCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKFsnaXNMb2dpbicsICdhY2Nlc3NfdG9rZW4nXSksCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKFsnbG9nb3V0J10pLAogICAgdXBkYXRlRW1vdGlvbjogZnVuY3Rpb24oZW1vdGlvbil7CiAgICAgIHRoaXMuZW1vdGlvbiA9IGVtb3Rpb247CiAgICB9LAogICAgZGlhcnlXcml0ZTogZnVuY3Rpb24oZGlhcnlPYmopIHsKICAgICAgaWYodGhpcy5lbW90aW9uID09PSAiIil7CiAgICAgICAgdGhpcy4kYWxlcnQoIuyYpOuKmOydmCDqsJDsoJXsnYQg7ISg7YOd7ZW0IOyjvOyEuOyalC4iLCIiLCJpbmZvIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IGlzX3ZhbGlkID0gdGhpcy4kcmVmcy5kaWFyeWZvcm0udmFsaWRhdGUoKTsKICAgICAgaWYoaXNfdmFsaWQpewogICAgICAgIGNvbnN0IGNvbmZpZyA9IHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYWNjZXNzX3Rva2VufWAsCiAgICAgICAgICB9LAogICAgICAgIH07CiAgICAgICAgdGhpcy5heGlvcwogICAgICAgICAgLnBvc3QoYCR7dGhpcy4kc3RvcmUuc3RhdGUuQkFDS0VORF9VUkx9L2FwaS9kaWFyeS8ke3RoaXMuYXBpVXJsfWAsIGRpYXJ5T2JqLCBjb25maWcpCiAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgIGlmKHRoaXMuYXBpVXJsID09PSAid3JpdGUiKXsKICAgICAgICAgICAgICB0aGlzLiRhbGVydChg7J286riwIOyekeyEseyXkCDshLHqs7XtlojsirXri4jri6QuYCwiIiwic3VjY2VzcyIpOwogICAgICAgICAgICAgIHRoaXMuJHJlZnMuZGlhcnlmb3JtLnJlc2V0KCk7CiAgICAgICAgICAgIH0gZWxzZSBpZih0aGlzLmFwaVVybCA9PT0gInJld3JpdGUiKXsKICAgICAgICAgICAgICB0aGlzLiRhbGVydChg7J286riwIOyImOygleyXkCDshLHqs7XtlojsirXri4jri6QuYCwiIiwic3VjY2VzcyIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTsKICAgICAgICAgICAgdGhpcy4kYWxlcnQoIuyEuOyFmOydtCDrp4zro4zrkJjsl4jsirXri4jri6QuIOuLpOyLnCDroZzqt7jsnbgg7ZW07KO87IS47JqULiIsIiIsImVycm9yIik7CiAgICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpewogICAgaWYoIXRoaXMuaXNMb2dpbil7CiAgICAgIHRoaXMuJGFsZXJ0KCLroZzqt7jsnbjsnbQg7ZWE7JqU7ZWcIO2OmOydtOyngOyeheuLiOuLpC4iLCIiLCJ3YXJuaW5nIik7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvJyk7CiAgICB9CiAgICBpZih0aGlzLiRyb3V0ZS5xdWVyeS5pZCAhPT0gdW5kZWZpbmVkKXsKICAgICAgdGhpcy5hcGlVcmwgPSAicmV3cml0ZSI7CiAgICAgIGNvbnN0IGNvbmZpZyA9IHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hY2Nlc3NfdG9rZW59YCwKICAgICAgICB9LAogICAgICB9OwogICAgICB0aGlzLmF4aW9zCiAgICAgICAgLnBvc3QoYCR7dGhpcy4kc3RvcmUuc3RhdGUuQkFDS0VORF9VUkx9L2FwaS9kaWFyeS9nZXRgLCB7ImlkIjp0aGlzLiRyb3V0ZS5xdWVyeS5pZH0sIGNvbmZpZykKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLnRpdGxlID0gcmVzLmRhdGEudGl0bGU7CiAgICAgICAgICB0aGlzLmNvbnRlbnQgPSByZXMuZGF0YS5jb250ZW50OwogICAgICAgICAgdGhpcy5lbW90aW9uID0gcmVzLmRhdGEuZW1vdGlvbjsKICAgICAgICAgIHRoaXMuaXNMb2FkZWQgPSB0cnVlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgaWYoZXJyb3IucmVzcG9uc2UuZGF0YS5kZXRhaWwgPT09ICLtlbTri7ntlZjripQg7J286riw6rCAIOyhtOyerO2VmOyngCDslYrsirXri4jri6QuIil7CiAgICAgICAgICAgIHRoaXMuJGFsZXJ0KCLtlbTri7ntlZjripQg7J286riw6rCAIOyhtOyerO2VmOyngCDslYrsirXri4jri6QuIiwiIiwiZXJyb3IiKTsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvKC0xKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuJGFsZXJ0KCJbRFcwMDFdIOyYiOyDgey5mCDrqrvtlZwg7JeQ65+s6rCAIOuwnOyDne2WiOyKteuLiOuLpC4g6rOg6rCd7IS87YSw66GcIOusuOydmCDrsJTrno3ri4jri6QuIiwiIiwiZXJyb3IiKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaXNMb2FkZWQgPSB0cnVlOwogICAgfQogIH0KfQo="},{"version":3,"sources":["DiaryWrite.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DiaryWrite.vue","sourceRoot":"src/views","sourcesContent":["<template lang=\"\">\n    <div class=\"pb-8\">\n    <v-card class=\"group pa-2\">\n      <v-icon small style=\"margin-left:5px\">home</v-icon>\n      <v-breadcrumbs :items=\"bcLink\"></v-breadcrumbs>\n    </v-card>\n    <v-layout align-center column fill-height class=\"py-8 px-4\">\n      <v-card class=\"py-8 px-4 ma-4\" style=\"max-width: 900px; width: 900px; height: 700px\">\n        <v-card-title class=\"justify-center\">\n          오늘 나의 감정\n        </v-card-title>\n        <v-layout justify-center>\n          <Emotions\n            v-if=\"isLoaded\"\n            :propEmotion=\"emotion\"\n            @emotion-extract=\"updateEmotion\"\n          > </Emotions>\n        </v-layout>\n        <v-form ref=\"diaryform\" lazy-validation>\n          <v-text-field\n            v-model=\"title\"\n            label=\"제목\"\n            :rules=\"titleRules\"\n            clearable\n          ></v-text-field>\n          <v-textarea\n          counter\n          v-model=\"content\"\n          label=\"내용\"\n          :rules=\"contentRules\"\n          rows=\"15\"\n          row-height=\"30\"\n          ></v-textarea>\n        </v-form>\n      </v-card>\n      <v-layout justify-center>\n          <v-btn @click=\"diaryWrite({'id':$route.query.id, title, content, emotion})\">\n            작성하기\n          </v-btn>\n      </v-layout>\n    </v-layout>\n    </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport Emotions from '../components/Emotions'\n\nexport default {\n  components: {\n    Emotions,\n  },\n  data: ()=> ({\n    bcLink: [\n      {\n        text: '대시보드',\n        disabled: false,\n        href: 'Dashboard',\n      },\n      {\n        text: '일기',\n        disabled: false,\n        href: 'diary',\n      },\n      {\n        text: '일기 쓰기',\n        disabled: false,\n        href: 'diary-write',\n      },\n    ],\n    emotion: \"\",\n    title: \"\",\n    titleRules: [\n      v => !!v || '제목은 필수 항목입니다.',\n      v => v.length < 25 || '제목은 25자 이하로 적어주세요.'\n    ],\n    content: \"\",\n    contentRules: [\n      v => !!v || '내용은 필수 항목입니다.',\n      v => v.length < 1500 || '내용은 1500자 이하로 적어주세요.'\n    ],\n    apiUrl: \"write\",\n    isLoaded: false,\n  }),\n  computed: {\n    ...mapState(['isLogin', 'access_token']),\n  },\n  methods: {\n    ...mapActions(['logout']),\n    updateEmotion: function(emotion){\n      this.emotion = emotion;\n    },\n    diaryWrite: function(diaryObj) {\n      if(this.emotion === \"\"){\n        this.$alert(\"오늘의 감정을 선택해 주세요.\",\"\",\"info\");\n        return;\n      }\n      const is_valid = this.$refs.diaryform.validate();\n      if(is_valid){\n        const config = {\n          headers: {\n            Authorization: `Bearer ${this.access_token}`,\n          },\n        };\n        this.axios\n          .post(`${this.$store.state.BACKEND_URL}/api/diary/${this.apiUrl}`, diaryObj, config)\n          .then(() => {\n            if(this.apiUrl === \"write\"){\n              this.$alert(`일기 작성에 성공했습니다.`,\"\",\"success\");\n              this.$refs.diaryform.reset();\n            } else if(this.apiUrl === \"rewrite\"){\n              this.$alert(`일기 수정에 성공했습니다.`,\"\",\"success\");\n            }\n          })\n          .catch(() => {\n            this.logout();\n            this.$alert(\"세션이 만료되었습니다. 다시 로그인 해주세요.\",\"\",\"error\");\n          });\n      }\n    }\n  },\n  created(){\n    if(!this.isLogin){\n      this.$alert(\"로그인이 필요한 페이지입니다.\",\"\",\"warning\");\n      this.$router.push('/');\n    }\n    if(this.$route.query.id !== undefined){\n      this.apiUrl = \"rewrite\";\n      const config = {\n        headers: {\n          Authorization: `Bearer ${this.access_token}`,\n        },\n      };\n      this.axios\n        .post(`${this.$store.state.BACKEND_URL}/api/diary/get`, {\"id\":this.$route.query.id}, config)\n        .then((res) => {\n          this.title = res.data.title;\n          this.content = res.data.content;\n          this.emotion = res.data.emotion;\n          this.isLoaded = true;\n        })\n        .catch((error) => {\n          if(error.response.data.detail === \"해당하는 일기가 존재하지 않습니다.\"){\n            this.$alert(\"해당하는 일기가 존재하지 않습니다.\",\"\",\"error\");\n            this.$router.go(-1);\n          } else {\n            this.$alert(\"[DW001] 예상치 못한 에러가 발생했습니다. 고객센터로 문의 바랍니다.\",\"\",\"error\");\n          }\n        });\n    } else {\n      this.isLoaded = true;\n    }\n  }\n}\n</script>\n<style lang=\"\">\n    \n</style>"]}]}