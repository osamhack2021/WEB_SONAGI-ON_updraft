{"remainingRequest":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/workspaces/WEB_SONAGI-ON_updraft/frontend/src/views/DiaryWrite.vue?vue&type=script&lang=js&","dependencies":[{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/src/views/DiaryWrite.vue","mtime":1634648827355},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1634648816471},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/babel-loader/lib/index.js","mtime":1634648816471},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1634648816471},{"path":"/workspaces/WEB_SONAGI-ON_updraft/frontend/node_modules/vue-loader/lib/index.js","mtime":1634648814815}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcKaW1wb3J0IEVtb3Rpb25zIGZyb20gJy4uL2NvbXBvbmVudHMvc2lkZV9tb2R1bGVzL0Vtb3Rpb25zJwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEVtb3Rpb25zLAogIH0sCiAgZGF0YTogKCk9PiAoewogICAgYmNMaW5rOiBbCiAgICAgIHsKICAgICAgICB0ZXh0OiAn64yA7Iuc67O065OcJywKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgICAgaHJlZjogJy8nLAogICAgICB9LAogICAgICB7CiAgICAgICAgdGV4dDogJ+ydvOq4sCcsCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGhyZWY6ICdkaWFyeScsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICB0ZXh0OiAn7J286riwIOyTsOq4sCcsCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGhyZWY6ICdkaWFyeS13cml0ZScsCiAgICAgIH0sCiAgICBdLAogICAgZW1vdGlvbjogIiIsCiAgICB0aXRsZTogIiIsCiAgICB0aXRsZVJ1bGVzOiBbCiAgICAgIHYgPT4gISF2IHx8ICfsoJzrqqnsnYAg7ZWE7IiYIO2VreuqqeyeheuLiOuLpC4nLAogICAgICB2ID0+IHYubGVuZ3RoIDwgMjUgfHwgJ+ygnOuqqeydgCAyNeyekCDsnbTtlZjroZwg7KCB7Ja07KO87IS47JqULicKICAgIF0sCiAgICBjb250ZW50OiAiIiwKICAgIGNvbnRlbnRSdWxlczogWwogICAgICB2ID0+ICEhdiB8fCAn64K07Jqp7J2AIO2VhOyImCDtla3rqqnsnoXri4jri6QuJywKICAgICAgdiA9PiB2Lmxlbmd0aCA8IDE1MDAgfHwgJ+uCtOyaqeydgCAxNTAw7J6QIOydtO2VmOuhnCDsoIHslrTso7zshLjsmpQuJwogICAgXSwKICAgIGFwaVVybDogIndyaXRlIiwKICAgIGlzTG9hZGVkOiBmYWxzZSwKICB9KSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoWydpc0xvZ2luJywgJ2FjY2Vzc190b2tlbiddKSwKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoWydsb2dvdXQnXSksCiAgICB1cGRhdGVFbW90aW9uOiBmdW5jdGlvbihlbW90aW9uKXsKICAgICAgdGhpcy5lbW90aW9uID0gZW1vdGlvbjsKICAgIH0sCiAgICBkaWFyeVdyaXRlOiBmdW5jdGlvbihkaWFyeU9iaikgewogICAgICBpZih0aGlzLmVtb3Rpb24gPT09ICIiKXsKICAgICAgICB0aGlzLiRhbGVydCgi7Jik64qY7J2YIOqwkOygleydhCDshKDtg53tlbQg7KO87IS47JqULiIsIiIsImluZm8iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3QgaXNfdmFsaWQgPSB0aGlzLiRyZWZzLmRpYXJ5Zm9ybS52YWxpZGF0ZSgpOwogICAgICBpZihpc192YWxpZCl7CiAgICAgICAgY29uc3QgY29uZmlnID0gewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hY2Nlc3NfdG9rZW59YCwKICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgICB0aGlzLmF4aW9zCiAgICAgICAgICAucG9zdChgJHt0aGlzLiRzdG9yZS5zdGF0ZS5CQUNLRU5EX1VSTH0vYXBpL2RpYXJ5LyR7dGhpcy5hcGlVcmx9YCwgZGlhcnlPYmosIGNvbmZpZykKICAgICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgaWYodGhpcy5hcGlVcmwgPT09ICJ3cml0ZSIpewogICAgICAgICAgICAgIHRoaXMuJGFsZXJ0KGDsnbzquLAg7J6R7ISx7JeQIOyEseqzte2WiOyKteuLiOuLpC5gLCIiLCJzdWNjZXNzIik7CiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5kaWFyeWZvcm0ucmVzZXQoKTsKICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMuYXBpVXJsID09PSAicmV3cml0ZSIpewogICAgICAgICAgICAgIHRoaXMuJGFsZXJ0KGDsnbzquLAg7IiY7KCV7JeQIOyEseqzte2WiOyKteuLiOuLpC5gLCIiLCJzdWNjZXNzIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKCkgPT4gewogICAgICAgICAgICB0aGlzLmxvZ291dCgpOwogICAgICAgICAgICB0aGlzLiRhbGVydCgi7IS47IWY7J20IOunjOujjOuQmOyXiOyKteuLiOuLpC4g64uk7IucIOuhnOq3uOyduCDtlbTso7zshLjsmpQuIiwiIiwiZXJyb3IiKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkKCl7CiAgICBpZighdGhpcy5pc0xvZ2luKXsKICAgICAgdGhpcy4kYWxlcnQoIuuhnOq3uOyduOydtCDtlYTsmpTtlZwg7Y6Y7J207KeA7J6F64uI64ukLiIsIiIsIndhcm5pbmciKTsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy8nKTsKICAgIH0KICAgIGlmKHRoaXMuJHJvdXRlLnF1ZXJ5LmlkICE9PSB1bmRlZmluZWQpewogICAgICB0aGlzLmFwaVVybCA9ICJyZXdyaXRlIjsKICAgICAgY29uc3QgY29uZmlnID0gewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFjY2Vzc190b2tlbn1gLAogICAgICAgIH0sCiAgICAgIH07CiAgICAgIHRoaXMuYXhpb3MKICAgICAgICAucG9zdChgJHt0aGlzLiRzdG9yZS5zdGF0ZS5CQUNLRU5EX1VSTH0vYXBpL2RpYXJ5L2dldGAsIHsiaWQiOnRoaXMuJHJvdXRlLnF1ZXJ5LmlkfSwgY29uZmlnKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMudGl0bGUgPSByZXMuZGF0YS50aXRsZTsKICAgICAgICAgIHRoaXMuY29udGVudCA9IHJlcy5kYXRhLmNvbnRlbnQ7CiAgICAgICAgICB0aGlzLmVtb3Rpb24gPSByZXMuZGF0YS5lbW90aW9uOwogICAgICAgICAgdGhpcy5pc0xvYWRlZCA9IHRydWU7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICBpZihlcnJvci5yZXNwb25zZS5kYXRhLmRldGFpbCA9PT0gIu2VtOuLue2VmOuKlCDsnbzquLDqsIAg7KG07J6s7ZWY7KeAIOyViuyKteuLiOuLpC4iKXsKICAgICAgICAgICAgdGhpcy4kYWxlcnQoIu2VtOuLue2VmOuKlCDsnbzquLDqsIAg7KG07J6s7ZWY7KeAIOyViuyKteuLiOuLpC4iLCIiLCJlcnJvciIpOwogICAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kYWxlcnQoIltEVzAwMV0g7JiI7IOB7LmYIOuqu+2VnCDsl5Drn6zqsIAg67Cc7IOd7ZaI7Iq164uI64ukLiDqs6DqsJ3shLzthLDroZwg66y47J2YIOuwlOuejeuLiOuLpC4iLCIiLCJlcnJvciIpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5pc0xvYWRlZCA9IHRydWU7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["DiaryWrite.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DiaryWrite.vue","sourceRoot":"src/views","sourcesContent":["<template lang=\"\">\n    <div class=\"pb-8\">\n    <v-card class=\"group pa-2\">\n      <v-icon small style=\"margin-left:5px\">home</v-icon>\n      <v-breadcrumbs :items=\"bcLink\"></v-breadcrumbs>\n    </v-card>\n    <v-layout align-center column fill-height class=\"py-8 px-4\">\n      <v-card class=\"py-8 px-4 ma-4\" style=\"width: 900px; height: 700px\">\n        <v-card-title class=\"justify-center\">\n          오늘 나의 감정\n        </v-card-title>\n        <v-layout justify-center>\n          <Emotions\n            v-if=\"isLoaded\"\n            :propEmotion=\"emotion\"\n            @emotion-extract=\"updateEmotion\"\n          > </Emotions>\n        </v-layout>\n        <v-form ref=\"diaryform\" lazy-validation>\n          <v-text-field\n            v-model=\"title\"\n            label=\"제목\"\n            :rules=\"titleRules\"\n            clearable\n          ></v-text-field>\n          <v-textarea\n          counter\n          v-model=\"content\"\n          label=\"내용\"\n          :rules=\"contentRules\"\n          rows=\"15\"\n          row-height=\"30\"\n          ></v-textarea>\n        </v-form>\n      </v-card>\n      <v-layout justify-center>\n          <v-btn @click=\"diaryWrite({'id':$route.query.id, title, content, emotion})\">\n            작성하기\n          </v-btn>\n      </v-layout>\n    </v-layout>\n    </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport Emotions from '../components/side_modules/Emotions'\n\nexport default {\n  components: {\n    Emotions,\n  },\n  data: ()=> ({\n    bcLink: [\n      {\n        text: '대시보드',\n        disabled: false,\n        href: '/',\n      },\n      {\n        text: '일기',\n        disabled: false,\n        href: 'diary',\n      },\n      {\n        text: '일기 쓰기',\n        disabled: false,\n        href: 'diary-write',\n      },\n    ],\n    emotion: \"\",\n    title: \"\",\n    titleRules: [\n      v => !!v || '제목은 필수 항목입니다.',\n      v => v.length < 25 || '제목은 25자 이하로 적어주세요.'\n    ],\n    content: \"\",\n    contentRules: [\n      v => !!v || '내용은 필수 항목입니다.',\n      v => v.length < 1500 || '내용은 1500자 이하로 적어주세요.'\n    ],\n    apiUrl: \"write\",\n    isLoaded: false,\n  }),\n  computed: {\n    ...mapState(['isLogin', 'access_token']),\n  },\n  methods: {\n    ...mapActions(['logout']),\n    updateEmotion: function(emotion){\n      this.emotion = emotion;\n    },\n    diaryWrite: function(diaryObj) {\n      if(this.emotion === \"\"){\n        this.$alert(\"오늘의 감정을 선택해 주세요.\",\"\",\"info\");\n        return;\n      }\n      const is_valid = this.$refs.diaryform.validate();\n      if(is_valid){\n        const config = {\n          headers: {\n            Authorization: `Bearer ${this.access_token}`,\n          },\n        };\n        this.axios\n          .post(`${this.$store.state.BACKEND_URL}/api/diary/${this.apiUrl}`, diaryObj, config)\n          .then(() => {\n            if(this.apiUrl === \"write\"){\n              this.$alert(`일기 작성에 성공했습니다.`,\"\",\"success\");\n              this.$refs.diaryform.reset();\n            } else if(this.apiUrl === \"rewrite\"){\n              this.$alert(`일기 수정에 성공했습니다.`,\"\",\"success\");\n            }\n          })\n          .catch(() => {\n            this.logout();\n            this.$alert(\"세션이 만료되었습니다. 다시 로그인 해주세요.\",\"\",\"error\");\n          });\n      }\n    }\n  },\n  created(){\n    if(!this.isLogin){\n      this.$alert(\"로그인이 필요한 페이지입니다.\",\"\",\"warning\");\n      this.$router.push('/');\n    }\n    if(this.$route.query.id !== undefined){\n      this.apiUrl = \"rewrite\";\n      const config = {\n        headers: {\n          Authorization: `Bearer ${this.access_token}`,\n        },\n      };\n      this.axios\n        .post(`${this.$store.state.BACKEND_URL}/api/diary/get`, {\"id\":this.$route.query.id}, config)\n        .then((res) => {\n          this.title = res.data.title;\n          this.content = res.data.content;\n          this.emotion = res.data.emotion;\n          this.isLoaded = true;\n        })\n        .catch((error) => {\n          if(error.response.data.detail === \"해당하는 일기가 존재하지 않습니다.\"){\n            this.$alert(\"해당하는 일기가 존재하지 않습니다.\",\"\",\"error\");\n            this.$router.go(-1);\n          } else {\n            this.$alert(\"[DW001] 예상치 못한 에러가 발생했습니다. 고객센터로 문의 바랍니다.\",\"\",\"error\");\n          }\n        });\n    } else {\n      this.isLoaded = true;\n    }\n  }\n}\n</script>\n<style lang=\"\">\n    \n</style>"]}]}